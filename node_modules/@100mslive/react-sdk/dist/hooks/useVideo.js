import{__awaiter as r}from"../node_modules/tslib/tslib.es6.mjs.js";import{useRef as i,useCallback as e,useEffect as t}from"react";import{selectVideoTrackByID as d}from"@100mslive/hms-video-store";import{useHMSActions as o,useHMSStore as c}from"../primitives/HmsRoomProvider.js";import n from"../utils/logger.js";const u=({trackId:u,attach:l})=>{const v=o(),s=i(null),a=c(d(u)),m=i(),f=e((r=>{r&&(s.current=r)}),[]);return t((()=>{m.current?(null==a?void 0:a.id)&&m.current!==(null==a?void 0:a.id)&&r(void 0,void 0,void 0,(function*(){if(s.current)try{n.d("detaching because different track is passed"),yield v.detachVideo(m.current,s.current)}catch(r){n.w("detach video error for track",m.current,r)}m.current=null==a?void 0:a.id})):m.current=null==a?void 0:a.id}),[null==a?void 0:a.id,v]),t((()=>{r(void 0,void 0,void 0,(function*(){(null==a?void 0:a.id)&&s.current&&(!1!==l?yield v.attachVideo(a.id,s.current):yield v.detachVideo(a.id,s.current))}))}),[a,l,v]),t((()=>()=>{r(void 0,void 0,void 0,(function*(){if(s.current&&a)try{yield v.detachVideo(a.id,s.current)}catch(r){n.w("detach video error for track",a.id,r)}}))}),[]),{videoRef:f}};export{u as useVideo};
//# sourceMappingURL=useVideo.js.map

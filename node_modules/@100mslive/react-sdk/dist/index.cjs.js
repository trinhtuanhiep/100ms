"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("zustand"),i=require("@100mslive/hms-video-store"),r=require("react-resize-detector");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n,a,s=o(e),l=o(t);function c(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!1;for(let r=0;r<i.length;r++)if(!Object.prototype.hasOwnProperty.call(t,i[r])||!Object.is(e[i[r]],t[i[r]]))return!1;return!0}(a=n||(n={}))[a.VERBOSE=0]="VERBOSE",a[a.DEBUG=1]="DEBUG",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.NONE=5]="NONE";class u{static v(e,...t){this.log(n.VERBOSE,e,...t)}static d(e,...t){this.log(n.DEBUG,e,...t)}static i(e,...t){this.log(n.INFO,e,...t)}static w(e,...t){this.log(n.WARN,e,...t)}static e(e,...t){this.log(n.ERROR,e,...t)}static log(e,t,...i){if(!(this.level.valueOf()>e.valueOf()))switch(e){case n.VERBOSE:console.log("HMSui-components: ",t,...i);break;case n.DEBUG:console.debug("HMSui-components: ",t,...i);break;case n.INFO:console.info("HMSui-components: ",t,...i);break;case n.WARN:console.warn("HMSui-components: ",t,...i);break;case n.ERROR:console.error("HMSui-components: ",t,...i)}}}u.level=n.VERBOSE;const d="It seems like you forgot to add your component within a top level HMSRoomProvider, please refer to 100ms react docs(https://docs.100ms.live/javascript/v2/features/integration#react-hooks) to check on the required steps for using this hook.";const h="undefined"!=typeof window,f=e.createContext(null),g=(v=f,(t,i=c)=>{t||u.w("fetching full store without passing any selector may have a heavy performance impact on your website.");const r=e.useContext(v);if(!r)throw new Error(d);return(0,r.store)(t,i)});var v;const p=function(t){return(i,r=c)=>{i||u.w("fetching full store without passing any selector may have a heavy performance impact on your website.");const o=e.useContext(t);if(!o)throw new Error(d);const n=o.statsStore;return null==n?void 0:n(i,r)}}(f),m=()=>{const t=e.useContext(f);if(!t)throw new Error(d);return t.store},w=()=>{const t=e.useContext(f);if(!t)throw new Error(d);return t.notifications},y=()=>{const t=e.useContext(f);if(!t)throw new Error(d);return t.actions},S=t=>{const i=e.useContext(f),[r,o]=e.useState(null);if(!i)throw new Error(d);return e.useEffect((()=>{if(!i.notifications)return;return i.notifications.onNotification((e=>{o(e)}),t)}),[i.notifications,t]),r};function b(e,t,i,r){return new(i||(i=Promise))((function(o,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const P=(e,t)=>u.e("react-sdk",t,e);function E(t){const i=e.useRef();return e.useEffect((()=>{i.current=t})),i.current}const R=["chrome","brave","opera","edge"].some((e=>{var t,r;return(null===(r=null===(t=i.parsedUserAgent.getBrowser())||void 0===t?void 0:t.name)||void 0===r?void 0:r.toLowerCase())===e})),k=(t=P)=>{var r,o;const n=y(),a=g(i.selectIsLocalScreenShared),s=g(i.selectPeerScreenSharing),l=g(i.selectScreenSharesByPeerId(null==s?void 0:s.id)),c=e.useCallback((e=>b(void 0,void 0,void 0,(function*(){try{yield n.setScreenShareEnabled(!a,e)}catch(e){t(e,"toggleScreenShare")}}))),[n,a,t]);return{amIScreenSharing:a,screenSharingPeerId:null==s?void 0:s.id,screenSharingPeerName:null==s?void 0:s.name,screenShareVideoTrackId:null===(r=null==l?void 0:l.video)||void 0===r?void 0:r.id,screenShareAudioTrackId:null===(o=null==l?void 0:l.audio)||void 0===o?void 0:o.id,toggleScreenShare:c}},I=(e,t,i)=>b(void 0,void 0,void 0,(function*(){if(t)try{yield e.setRemoteTrackEnabled(t.id,!t.enabled)}catch(e){i(e,"remoteToggle")}})),C=({elements:e,tilesInFirstPage:t,onlyOnePage:i,isLastPageDifferentFromFirstPage:r,defaultWidth:o,defaultHeight:n,lastPageWidth:a,lastPageHeight:s})=>{const l=((e,t,i)=>e.reduce(((e,r,o)=>{const n=Math.floor(o/t);return n>0&&i||(e[n]||(e[n]=[]),e[n].push(r)),e}),[]))(e,t,i);return l.map(((e,t)=>e.map((e=>{const i=t===l.length-1,c=r&&i?a:o,u=r&&i?s:n;return Object.assign(Object.assign({},e),{height:u,width:c})}))))};const M=(e,t,i,r,o)=>{if(e<0||t<0)throw new Error("Container must have a non-negative area");if(i<1||!Number.isInteger(i))throw new Error("Number of shapes to place must be a positive integer");const n=r&&o&&r/o;if(void 0!==n&&isNaN(n))throw new Error("Aspect ratio must be a number");let a={area:0,cols:0,rows:0,width:0,height:0};if(void 0!==n)for(let r=i;r>0;r+=-1){const o=Math.ceil(i/r);let s,l;e/(r*n)<=t/o?(s=e/r,l=s/n):(l=t/o,s=l*n);const c=s*l;c>a.area&&(a={area:c,width:s,height:l,rows:o,cols:r})}return a};function x({count:e,parentWidth:t,parentHeight:i,maxTileCount:r,maxRowCount:o,maxColCount:n,aspectRatio:a}){let s=0,l=0,c=0,u=0,d=!1,h=0;if(0===e)return{tilesInFirstPage:h,defaultWidth:s,defaultHeight:l,lastPageWidth:c,lastPageHeight:u,isLastPageDifferentFromFirstPage:d};if(r)({tilesInFirstPage:h,defaultWidth:s,defaultHeight:l,lastPageWidth:c,lastPageHeight:u,isLastPageDifferentFromFirstPage:d}=(({parentWidth:e,parentHeight:t,count:i,maxCount:r,aspectRatio:o})=>{let n=0,a=0,s=0,l=0,c=!1,u=0,d=0;const{width:h,height:f}=M(e,t,Math.min(i,r),o.width,o.height);if(n=h,a=f,u=Math.min(i,r),d=i%r,c=d>0&&i>r,c){const{width:i,height:r}=M(e,t,d,o.width,o.height);s=i,l=r}return{tilesInFirstPage:u,defaultWidth:n,defaultHeight:a,lastPageWidth:s,lastPageHeight:l,isLastPageDifferentFromFirstPage:c}})({parentWidth:t,parentHeight:i,count:e,maxCount:r,aspectRatio:a}));else if(o)({tilesInFirstPage:h,defaultWidth:s,defaultHeight:l,lastPageWidth:c,lastPageHeight:u,isLastPageDifferentFromFirstPage:d}=(({parentWidth:e,parentHeight:t,count:i,maxCount:r,aspectRatio:o})=>{let n=0,a=0,s=0,l=0,c=!1,u=0,d=0;const h=Math.min(Math.ceil(Math.sqrt(i*(o.width/o.height)/(e/t))),r),f=t/h,g=f*(o.width/o.height),v=Math.floor(e/g);if(n=g,a=f,u=Math.min(i,h*v),d=i%(h*v),c=d>0&&i>h*v,c){const i=t/Math.min(Math.ceil(Math.sqrt(d*(o.width/o.height)/(e/t))),r);l=i,s=i*(o.width/o.height)}return{tilesInFirstPage:u,defaultWidth:n,defaultHeight:a,lastPageWidth:s,lastPageHeight:l,isLastPageDifferentFromFirstPage:c}})({parentWidth:t,parentHeight:i,count:e,maxCount:o,aspectRatio:a}));else if(n)({tilesInFirstPage:h,defaultWidth:s,defaultHeight:l,lastPageWidth:c,lastPageHeight:u,isLastPageDifferentFromFirstPage:d}=(({parentWidth:e,parentHeight:t,count:i,maxCount:r,aspectRatio:o})=>{let n=0,a=0,s=0,l=0,c=!1,u=0,d=0;const h=Math.min(Math.ceil(Math.sqrt(i*(e/t)/(o.width/o.height))),r);let f=e/h,g=f/(o.width/o.height);g>t&&(g=t,f=g/(o.height/o.width));const v=Math.floor(t/g);if(a=g,n=f,u=Math.min(i,v*h),d=i%(v*h),c=d>0&&i>v*h,c){let i=e/Math.min(Math.ceil(Math.sqrt(d*(e/t)/(o.width/o.height))),r),n=i/(o.width/o.height);n>t&&(n=t,i=n/(o.height/o.width)),l=n,s=i}return{tilesInFirstPage:u,defaultWidth:n,defaultHeight:a,lastPageWidth:s,lastPageHeight:l,isLastPageDifferentFromFirstPage:c}})({parentWidth:t,parentHeight:i,count:e,maxCount:n,aspectRatio:a}));else{const{width:r,height:o}=M(t,i,e,a.width,a.height);s=r,l=o,h=e}return{tilesInFirstPage:h,defaultWidth:s,defaultHeight:l,lastPageWidth:c,lastPageHeight:u,isLastPageDifferentFromFirstPage:d}}const H=(e,t,i,r=!0)=>{if(!e||!t||!i)return[];const o=[];for(const n of e){if(void 0===n.videoTrack&&n.audioTrack&&t[n.audioTrack]?o.push({peer:n}):n.videoTrack&&t[n.videoTrack]?o.push({track:t[n.videoTrack],peer:n}):r||o.push({peer:n}),n.auxiliaryTracks.length>0&&n.auxiliaryTracks.forEach((e=>{const i=t[e];"video"===(null==i?void 0:i.type)&&"regular"===(null==i?void 0:i.source)&&o.push({track:i,peer:n})})),i(n)&&n.auxiliaryTracks.length>0){const e=n.auxiliaryTracks.find((e=>{const i=t[e];return"video"===(null==i?void 0:i.type)&&"screen"===(null==i?void 0:i.source)}));e&&o.push({track:t[e],peer:n})}}return o},T={width:1,height:1};exports.HMSRoomProvider=({children:t,actions:r,store:o,notifications:n,stats:a,isHMSStatsOn:c=!1,leaveOnUnload:u=!0})=>{const d=e.useMemo((()=>{let e;const t=()=>{throw new Error("modifying store is not allowed")};if(r&&o)e={actions:r,store:l.default(Object.assign(Object.assign({},o),{setState:t,destroy:t}))},n&&(e.notifications=n),a&&(e.statsStore=l.default({getState:a.getState,subscribe:a.subscribe,setState:t,destroy:t}));else{const r=new i.HMSReactiveStore;if(e={actions:r.getActions(),store:l.default(Object.assign(Object.assign({},r.getStore()),{setState:t,destroy:t})),notifications:r.getNotifications()},c){const i=r.getStats();e.statsStore=l.default({getState:i.getState,subscribe:i.subscribe,setState:t,destroy:t})}}return e.actions.setFrameworkInfo({type:"react-web",version:s.default.version,sdkVersion:"0.8.16"}),e}),[r,o,n,a,c]);return e.useEffect((()=>{if(h&&u){const e=()=>d.actions.leave();return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}return()=>{}}),[u,d]),s.default.createElement(f.Provider,{value:d},t)},exports.getPeersWithTiles=H,exports.throwErrorHandler=e=>{throw e},exports.useAVToggle=(t=P)=>{const r=g(i.selectIsLocalAudioEnabled),o=g(i.selectIsLocalVideoEnabled),n=g(i.selectIsInPreview)?i.selectIsAllowedToPreviewMedia:i.selectIsAllowedToPublish,a=g(n),s=y(),l=e.useCallback((()=>b(void 0,void 0,void 0,(function*(){try{yield s.setLocalAudioEnabled(!r)}catch(e){t(e,"toggleAudio")}}))),[s,r,t]),c=e.useCallback((()=>b(void 0,void 0,void 0,(function*(){try{yield s.setLocalVideoEnabled(!o)}catch(e){t(e,"toggleVideo")}}))),[s,o,t]);return{isLocalAudioEnabled:r,isLocalVideoEnabled:o,toggleAudio:(null==a?void 0:a.audio)?l:void 0,toggleVideo:(null==a?void 0:a.video)?c:void 0}},exports.useAudioLevelStyles=function({trackId:t,getStyle:r,ref:o}){const n=m();e.useEffect((()=>n.subscribe((e=>{if(!o.current)return;const t=r(e);for(const e in t)o.current.style[e]=t[e]}),i.selectTrackAudioByID(t))),[r,o,n,t])},exports.useAutoplayError=()=>{const t=S(i.HMSNotificationTypes.ERROR),[r,o]=e.useState(""),n=y(),a=e.useCallback((()=>b(void 0,void 0,void 0,(function*(){yield n.unblockAudio()}))),[n]);return e.useEffect((()=>{3008===(null==t?void 0:t.data.code)&&o(null==t?void 0:t.data.message)}),[t]),{error:r,unblockAudio:a,resetError:()=>o("")}},exports.useCustomEvent=({type:t,json:r=!0,onEvent:o,handleError:n=P})=>{const a=y(),s=w();e.useEffect((()=>{a.ignoreMessageTypes([t])}),[a,t]),e.useEffect((()=>{if(!s)return;return s.onNotification((e=>{const i=e.data;if(i&&i.type===t)try{const e=r?JSON.parse(i.message):i.message;null==o||o(e)}catch(e){n(e,"handleCustomEvent")}}),i.HMSNotificationTypes.NEW_MESSAGE)}),[s,t,r,o,n]);return{sendEvent:e.useCallback(((e,i)=>b(void 0,void 0,void 0,(function*(){try{const n=((e,t)=>t?JSON.stringify(e||""):e)(e,r);i&&Array.isArray(null==i?void 0:i.roleNames)?yield a.sendGroupMessage(n,i.roleNames,t):"string"==typeof(null==i?void 0:i.peerId)?yield a.sendDirectMessage(n,i.peerId,t):yield a.sendBroadcastMessage(n,t),null==o||o(e)}catch(e){n(e,"sendCustomEvent")}}))),[a,n,o,t,r])}},exports.useDevices=(t=P)=>{const r=y(),o=g(i.selectDevices),n=g(i.selectLocalMediaSettings),a=g(i.selectIsInPreview)?i.selectIsAllowedToPreviewMedia:i.selectIsAllowedToPublish,s=g(a),l={[i.DeviceType.audioOutput]:n.audioOutputDeviceId},c={[i.DeviceType.audioOutput]:o.audioOutput};s.video&&(c[i.DeviceType.videoInput]=o.videoInput,l[i.DeviceType.videoInput]=n.videoInputDeviceId),s.audio&&(c[i.DeviceType.audioInput]=o.audioInput,l[i.DeviceType.audioInput]=n.audioInputDeviceId);return{allDevices:c,selectedDeviceIDs:l,updateDevice:e.useCallback((({deviceType:e,deviceId:o})=>b(void 0,void 0,void 0,(function*(){try{switch(e){case i.DeviceType.audioInput:yield r.setAudioSettings({deviceId:o});break;case i.DeviceType.videoInput:yield r.setVideoSettings({deviceId:o});break;case i.DeviceType.audioOutput:yield r.setAudioOutputDevice(o)}}catch(e){t(e,"updateDevices")}}))),[t,r])}},exports.useEmbedShare=t=>{const i=e.useRef(null),[r,o]=e.useState(!1),n=e.useCallback((()=>{throw new Error("unable to start screen share")}),[]),a=e.useRef(!1),{amIScreenSharing:s,toggleScreenShare:l}=k(n),c=E(s),u=e.useCallback((()=>b(void 0,void 0,void 0,(function*(){s&&(yield null==l?void 0:l(),i.current=null)}))),[s,l]),d=e.useCallback((e=>b(void 0,void 0,void 0,(function*(){if(!a.current){if(!e)throw new Error("URL not found");if(s)throw new Error("You are already sharing");if(!i.current)throw new Error("Attach a reference `iframeRef` to iframe for sharing");i.current.src=e,a.current=!0,o(!0),yield null==l?void 0:l({forceCurrentTab:R,cropElement:i.current,preferCurrentTab:R})}}))),[s,l]);return e.useEffect((()=>{c&&!s&&(null==t||t(),i.current&&(i.current.src=""),a.current=!1,o(!1))}),[s,c,t]),{startEmbedShare:d,stopEmbedShare:u,iframeRef:i,isEmbedShareInProgress:r}},exports.useHMSActions=y,exports.useHMSNotifications=S,exports.useHMSStatsStore=p,exports.useHMSStore=g,exports.useHMSVanillaNotifications=w,exports.useHMSVanillaStore=m,exports.usePDFShare=t=>{const i=e.useRef(null),[r,o]=e.useState(!1),n=e.useCallback((()=>{throw new Error("unable to start screen share")}),[]),a=e.useRef(!1),{amIScreenSharing:s,toggleScreenShare:l}=k(n),c=E(s),u=e.useCallback((e=>{var t;i.current&&(null===(t=i.current.contentWindow)||void 0===t||t.postMessage({theme:2,file:e},"*"))}),[]),d=e.useCallback((()=>b(void 0,void 0,void 0,(function*(){s&&(yield null==l?void 0:l())}))),[s,l]),h=e.useCallback((e=>b(void 0,void 0,void 0,(function*(){if(!a.current){if(!e)throw new Error("File or url not found");if(s)throw new Error("You are already sharing");if(!i.current)throw new Error("Attach a reference `iframeRef` to iframe for sharing");i.current.src="https://pdf-annotation.100ms.live/generic/web/viewer.html"+("string"==typeof e?`?file=${e}`:""),i.current.onload=()=>{requestAnimationFrame((()=>{e instanceof File&&u(e)}))},a.current=!0,o(!0),yield null==l?void 0:l({forceCurrentTab:R,cropElement:i.current,preferCurrentTab:R})}}))),[s,u,l]);return e.useEffect((()=>{c&&!s&&(null==t||t(),i.current&&i.current.removeAttribute("src"),a.current=!1,o(!1))}),[s,c,t]),{startPDFShare:h,stopPDFShare:d,iframeRef:i,isPDFShareInProgress:r}},exports.useParticipantList=()=>{const t=g(i.selectIsConnectedToRoom),r=g(t?i.selectPeers:i.selectRemotePeers),o=g(i.selectPeerCount),n=e.useMemo((()=>{return(e=r)&&Array.isArray(e)&&0!==e.length?e.reduce(((e,t)=>t.roleName?(e[t.roleName]||(e[t.roleName]=[]),e[t.roleName].push(t),e):e),{}):{};var e}),[r]);return{roles:Object.keys(n),participantsByRoles:n,peerCount:o,isConnected:t}},exports.useParticipants=e=>{var t;const r=g(i.selectIsConnectedToRoom),o=g(i.selectPeerCount),n=g(i.selectAvailableRoleNames);let a=g(r?i.selectPeers:i.selectRemotePeers);const s=Array.from(new Set(a.map((e=>e.roleName)))),l=m();if((null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.isHandRaised)&&(a=a.filter((e=>l.getState(i.selectPeerMetadata(e.id)).isHandRaised))),(null==e?void 0:e.role)&&n.includes(e.role)&&(a=a.filter((t=>t.roleName===e.role))),null==e?void 0:e.search){const t=e.search.toLowerCase();a=a.filter((e=>{var i;return(null===(i=e.roleName)||void 0===i?void 0:i.toLowerCase().includes(t))||e.name.toLowerCase().includes(t)}))}return{participants:a,isConnected:r,peerCount:o,rolesWithParticipants:s}},exports.usePreviewJoin=({name:t="",token:r,metadata:o,handleError:n=P,initEndpoint:a,initialSettings:s,captureNetworkQualityInPreview:l,asRole:c,autoManageVideo:u,autoManageWakeLock:d})=>{const h=y(),f=g(i.selectRoomState),v=g(i.selectIsConnectedToRoom)||!1,p=f===i.HMSRoomState.Preview,m=e.useMemo((()=>({userName:t,authToken:r,metaData:o,rememberDeviceSelection:!0,settings:s,initEndpoint:a,asRole:c,captureNetworkQualityInPreview:l,autoManageVideo:u,autoManageWakeLock:d})),[t,r,o,a,s,l,c,u,d]),w=e.useCallback((()=>b(void 0,void 0,void 0,(function*(){if(r)try{(v||f!==i.HMSRoomState.Disconnected)&&(yield h.leave().catch((()=>{}))),yield h.preview(m)}catch(e){n(e,"preview")}}))),[r,v,f,h,m,n]);return{enableJoin:p,join:e.useCallback((()=>b(void 0,void 0,void 0,(function*(){if(r)try{yield h.join(m)}catch(e){n(e,"join")}}))),[h,m,n,r]),isConnected:v,preview:w}},exports.useRecordingStreaming=()=>{const e=g(i.selectRecordingState),t=g(i.selectRTMPState),r=g(i.selectHLSState),o=e.server.running,n=e.browser.running,a=e.hls.running,s=o||n||a;return{isServerRecordingOn:o,isBrowserRecordingOn:n,isHLSRecordingOn:a,isStreamingOn:r.running||t.running,isHLSRunning:r.running,isRTMPRunning:t.running,isRecordingOn:s}},exports.useRemoteAVToggle=(t,r,o=P)=>{const n=y(),a=g(i.selectAudioTrackByID(t)),s=g(i.selectVideoTrackByID(r)),l=g(i.selectAudioTrackVolume(null==a?void 0:a.id)),c=g(i.selectPermissions),u=(null==s?void 0:s.enabled)?null==c?void 0:c.mute:null==c?void 0:c.unmute,d=(null==a?void 0:a.enabled)?null==c?void 0:c.mute:null==c?void 0:c.unmute,h=e.useCallback((()=>b(void 0,void 0,void 0,(function*(){yield I(n,a,o)}))),[n,a,o]),f=e.useCallback((()=>b(void 0,void 0,void 0,(function*(){yield I(n,s,o)}))),[n,o,s]),v=e.useCallback((e=>{a&&n.setVolume(e,a.id)}),[n,a]);return{isAudioEnabled:!!(null==a?void 0:a.enabled),isVideoEnabled:!!(null==s?void 0:s.enabled),volume:l,toggleAudio:a&&d?h:void 0,toggleVideo:"regular"===(null==s?void 0:s.source)&&u?f:void 0,setVolume:a?v:void 0}},exports.useScreenShare=k,exports.useVideo=({trackId:t,attach:r})=>{const o=y(),n=e.useRef(null),a=g(i.selectVideoTrackByID(t)),s=e.useRef(),l=e.useCallback((e=>{e&&(n.current=e)}),[]);return e.useEffect((()=>{s.current?(null==a?void 0:a.id)&&s.current!==(null==a?void 0:a.id)&&b(void 0,void 0,void 0,(function*(){if(n.current)try{u.d("detaching because different track is passed"),yield o.detachVideo(s.current,n.current)}catch(e){u.w("detach video error for track",s.current,e)}s.current=null==a?void 0:a.id})):s.current=null==a?void 0:a.id}),[null==a?void 0:a.id,o]),e.useEffect((()=>{b(void 0,void 0,void 0,(function*(){(null==a?void 0:a.id)&&n.current&&(!1!==r?yield o.attachVideo(a.id,n.current):yield o.detachVideo(a.id,n.current))}))}),[a,r,o]),e.useEffect((()=>()=>{b(void 0,void 0,void 0,(function*(){if(n.current&&a)try{yield o.detachVideo(a.id,n.current)}catch(e){u.w("detach video error for track",a.id,e)}}))}),[]),{videoRef:l}},exports.useVideoList=({peers:t,maxTileCount:o,maxColCount:n,maxRowCount:a,includeScreenShareForPeer:s=(()=>!1),aspectRatio:l=T,filterNonPublishingPeers:c=!0,offsetY:u=0})=>{const{width:d=0,height:h=0,ref:f}=r.useResizeDetector(),g=m().getState(i.selectTracksMap),v=H(t,g,s,c),p=e.useMemo((()=>{if(l)return l;return{width:function(e){if(0===e.length)return null;const t={};let i=e[0],r=1;for(let o=0;o<e.length;o++){const n=e[o];null===t[n]?t[n]=1:t[n]++,t[n]>r&&(i=n,r=t[n])}return i}(v.filter((e=>{var t,i;return(null===(t=e.track)||void 0===t?void 0:t.width)&&(null===(i=e.track)||void 0===i?void 0:i.height)})).map((e=>{var t,i;return((null===(t=e.track)||void 0===t?void 0:t.width)||1)/((null===(i=e.track)||void 0===i?void 0:i.height)||1)})))||1,height:1}}),[l,v]),w=v.length,{tilesInFirstPage:y,defaultWidth:S,defaultHeight:b,lastPageWidth:P,lastPageHeight:E,isLastPageDifferentFromFirstPage:R}=e.useMemo((()=>x({count:w,parentWidth:Math.floor(d),parentHeight:Math.floor(h)-Math.min(h,u),maxTileCount:o,maxRowCount:a,maxColCount:n,aspectRatio:p})),[w,d,h,o,a,n,p,u]);return{pagesWithTiles:e.useMemo((()=>C({elements:v,tilesInFirstPage:y,onlyOnePage:!1,isLastPageDifferentFromFirstPage:R,defaultWidth:S,defaultHeight:b,lastPageWidth:P,lastPageHeight:E})),[v,y,R,S,b,P,E]),ref:f}},Object.keys(i).forEach((function(e){"default"===e||exports.hasOwnProperty(e)||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return i[e]}})}));
//# sourceMappingURL=index.cjs.js.map
